# オーケストラ・エキストラ連絡ポータル 要件定義

---

## ✅ ユーザー種別

- **管理者**：ログインして演奏会情報の登録・編集を行う
- **エキストラ（閲覧者）**：共通ログインで情報閲覧・出欠入力を行う

---

## ✅ 機能一覧（要件詳細）

---

### 1. ログイン機能

| 項目               | 内容                                                                                                                                                                    |
| ------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **目的**           | 管理者/閲覧者の区別と、アクセス制御を行う                                                                                                                               |
| **エンドユーザー** | 管理者 / エキストラ（共通アカウント）                                                                                                                                   |
| **機能詳細**       | - 管理者：ID ＋パスワードでログイン<br>- 閲覧者：共通ログイン（パス付き URL or 共通 ID）<br>- **セッション維持（最低 1 日）**：リロード・ブラウザ再起動でもログイン継続 |
| **備考**           | ローカルストレージまたは Cookie でセッショントークンを管理                                                                                                              |

---

### 2. 演奏会管理

| 項目               | 内容                                                                                                             |
| ------------------ | ---------------------------------------------------------------------------------------------------------------- |
| **目的**           | 複数の演奏会ごとに情報を整理・管理                                                                               |
| **エンドユーザー** | 管理者 / 閲覧者                                                                                                  |
| **機能詳細**       | - 演奏会の作成・編集・削除（管理者）<br>- 演奏会を選択して内容を切り替え（閲覧者）<br>- 最後に開いた演奏会を記憶 |
| **備考**           | トップの演奏会切替セレクタなどで操作                                                                             |

---

### 3. 出欠フォームリンク管理

| 項目               | 内容                                                                          |
| ------------------ | ----------------------------------------------------------------------------- |
| **目的**           | 出欠入力フォーム（Google フォームなど）へリンク誘導する                       |
| **エンドユーザー** | 管理者 / 閲覧者                                                               |
| **機能詳細**       | - 管理者がリンクを登録・編集<br>- 閲覧者がボタン/リンクから外部フォームへ遷移 |
| **備考**           | 出欠情報の収集自体は外部サービス（Google フォームなど）に委任                 |

---

### 4. 楽譜リンク管理

| 項目               | 内容                                                         |
| ------------------ | ------------------------------------------------------------ |
| **目的**           | 楽譜データへのリンクを提供し、更新履歴も確認できるようにする |
| **エンドユーザー** | 管理者 / 閲覧者                                              |
| **機能詳細**       |

- 各楽譜には「曲名」と「楽譜 URL」が 1 つずつ紐づく（パート情報は不要）
- 閲覧者は「楽譜を開く」ボタンから URL に遷移できる
- 管理者は楽譜を追加・編集・削除できる
- 各楽譜に「更新履歴コメント」を複数追加可能
- 更新履歴は時系列順に表示され、編集・削除はできない
- 各楽譜ごとに「最終更新日時」を表示
- **リンク切れ検知機能**あり：定期的にリンク有効性をチェックし、切れていれば管理者にメール通知し、UI 上に ⚠ を表示
  | **通知内容（メール）** | - 対象演奏会名<br>- 楽譜タイトル<br>- 問題の URL<br>- ステータス（404 など）<br>- 発生日時 |
  | **備考** | コメントは履歴として残る（追記のみ）、編集や削除は不可 |

---

### 5. 練習予定管理（リスト＋詳細ページ）

| 項目               | 内容                                                                                                                                                                |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **目的**           | 練習のスケジュールや詳細情報を共有                                                                                                                                  |
| **エンドユーザー** | 管理者 / 閲覧者                                                                                                                                                     |
| **機能詳細**       | - **リストページ**：すべての予定を時系列順に表示<br>- **詳細ページ**：個別予定をクリックして詳細に遷移<br>　- 日時 / 場所 / 持ち物 / 注意事項 / メモ / 関連録音など |
| **備考**           | 過去予定は折りたたみ or グレーアウト表示で区別                                                                                                                      |

---

### 6. 管理者への連絡機能（メール）

| 項目               | 内容                                                                                              |
| ------------------ | ------------------------------------------------------------------------------------------------- |
| **目的**           | エキストラが問い合わせしたいときに連絡を取れるようにする                                          |
| **エンドユーザー** | 閲覧者                                                                                            |
| **機能詳細**       | - 管理者のメールアドレスをあらかじめ登録<br>- 「連絡する」ボタンを押すとメーラー起動（`mailto:`） |
| **備考**           | 履歴なし、匿名連絡も可（メール本文内で名乗る形式）                                                |

---

### 7. 最終更新日時表示

| 項目               | 内容                                                                             |
| ------------------ | -------------------------------------------------------------------------------- |
| **目的**           | 情報の鮮度を確認可能にする                                                       |
| **エンドユーザー** | 管理者 / 閲覧者                                                                  |
| **機能詳細**       | - 各セクションに個別の更新日時を表示<br>- トップに「全体最終更新日時」も表示可能 |
| **備考**           | 自動更新 or 管理者操作に紐づけて更新日時が更新される設計                         |
